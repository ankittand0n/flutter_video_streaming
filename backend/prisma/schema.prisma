generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "linux-musl-openssl-3.0.x"]
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model user {
  id             Int         @id @default(autoincrement())
  email          String      @unique(map: "user_email_key")
  password       String
  username       String      @unique(map: "user_username_key")
  profile_name   String
  profile_avatar String?
  is_active      Boolean     @default(true)
  last_login     DateTime    @default(now())
  created_at     DateTime    @default(now())
  updated_at     DateTime    @updatedAt
  rating         rating[]
  watchlist      watchlist[]
}

model rating {
  id         Int      @id @default(autoincrement())
  user_id    Int
  media_type String
  media_id   String
  rating     Decimal  @db.Decimal(3, 1)
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
  user       user     @relation(fields: [user_id], references: [id], onDelete: Cascade, map: "rating_user_id_fkey")

  @@unique([user_id, media_type, media_id], map: "rating_unique_user_rating")
  @@index([user_id], map: "rating_user_id_idx")
}

model watchlist {
  id          Int      @id @default(autoincrement())
  user_id     Int
  media_type  String
  media_id    String
  title       String
  poster_path String?
  created_at  DateTime @default(now())
  user        user     @relation(fields: [user_id], references: [id], onDelete: Cascade, map: "watchlist_user_id_fkey")

  @@unique([user_id, media_type, media_id], map: "watchlist_unique_user_media")
  @@index([user_id], map: "watchlist_user_id_idx")
}

model movie {
  id            Int       @id @default(autoincrement())
  title         String
  overview      String?
  release_date  DateTime?
  vote_average  Float?
  poster_path   String?
  backdrop_path String?
  genre_ids     String?
  video_url     String?
  trailer_url   String?
  trailer_urls  String[]  @default([])
  created_at    DateTime  @default(now())
  updated_at    DateTime? @updatedAt

  @@map("movies")
}

model tv_series {
  id                 Int       @id @default(autoincrement())
  name               String
  overview           String?
  first_air_date     DateTime?
  last_air_date      DateTime?
  vote_average       Float?
  poster_path        String?
  backdrop_path      String?
  genre_ids          String?
  number_of_seasons  Int?
  number_of_episodes Int?
  status             String?
  seasons            String?
  video_url          String?
  trailer_url        String?
  trailer_urls       String[]  @default([])
  created_at         DateTime  @default(now())
  updated_at         DateTime? @updatedAt

  @@map("tv_series")
}

model season {
  id            Int       @id @default(autoincrement())
  tv_series_id  Int?
  season_number Int?
  name          String?
  overview      String?
  poster_path   String?
  air_date      DateTime?
  episode_count Int?
  created_at    DateTime  @default(now())
  updated_at    DateTime? @updatedAt

  @@map("seasons")
}

model genre {
  id         Int      @id @default(autoincrement())
  name       String
  type       String
  created_at DateTime @default(now())

  @@map("genres")
}
